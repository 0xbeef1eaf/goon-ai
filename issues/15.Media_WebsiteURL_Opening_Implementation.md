## Objective
Implement functionality to open websites/URLs in the default browser.
## Tasks
### 1. Website Module Structure
- [ ] Create website module:
  ```
  src/
  └── media/
      └── website/
          ├── mod.rs
          └── opener.rs         // URL opening logic
  ```
### 2. URL Opening Implementation
- [ ] Use `open` crate for cross-platform support:
  ```rust
  open::that(url)?;
  ```
- [ ] Validate URL before opening
- [ ] Support both:
  - Pack-defined websites (by name)
  - Direct URLs
### 3. Website Registry
- [ ] Load websites from pack config:
  ```rust
  struct Website {
      name: String,
      url: String,
      description: String,
      tags: Vec<String>,
  }
  ```
- [ ] Query websites by name or tag
- [ ] Provide website suggestions to LLM
### 4. Op Implementation
- [ ] `op_open_website`:
  ```rust
  async fn op_open_website(
      state: Rc<RefCell<OpState>>,
      query: String,
  ) -> Result<()>
  ```
- [ ] Query types:
  - `name:Website Name` - Open by name from pack
  - `tag:tag1,tag2` - Open random website with tags
  - Direct URL - Open any URL
- [ ] Validate URL format
- [ ] Open in default browser
- [ ] Return success/error
### 5. URL Validation
- [ ] Parse and validate URLs:
  - Must have scheme (http/https)
  - Valid domain
  - No dangerous protocols (file://, javascript:)
- [ ] Use `url` crate for parsing
- [ ] Whitelist safe protocols
### 6. Security Considerations
- [ ] Prevent opening dangerous URLs
- [ ] Warn about unencrypted HTTP (optional)
- [ ] Validate pack-defined websites on load
- [ ] Consider URL filtering/blocking list (future)
### 7. Settings Integration
- [ ] Respect website permission
- [ ] Optional: Limit to pack-defined websites only
- [ ] Optional: Confirmation before opening (future)
### 8. Browser Detection
- [ ] Use system default browser
- [ ] Fallback to common browsers if default fails
- [ ] Platform-specific handling
### 9. Dependencies to Add
```toml
[dependencies]
# (existing dependencies)
open = "5.0"
url = "2.5"
```
### 10. Error Handling
- [ ] Handle browser not found
- [ ] Handle invalid URLs
- [ ] Handle permission denied
- [ ] Provide clear error messages
### 11. Pack Integration
- [ ] Parse websites from pack config
- [ ] Include in asset registry
- [ ] Tag-based queries
- [ ] Include in SDK documentation
## Example Usage (TypeScript)
```typescript
// Open pack-defined website by name
await openWebsite("name:Nature Conservancy");
// Open random website with tag
await openWebsite("tag:conservation");
// Open direct URL
await openWebsite("https://example.com");
// Open multiple tags
await openWebsite("tag:nature,conservation");
```
## Pack Configuration
```yaml
websites:
  - name: Nature Conservancy
    url: https://www.nature.org/en-us/
    description: A website dedicated to the conservation of nature and wildlife.
    tags:
      - nature
      - conservation
```
## Security
### Allowed Protocols
- `http://`
- `https://`
### Blocked Protocols
- `file://`
- `javascript:`
- `data:`
- `about:`
- Others
### Validation
- URL must parse correctly
- Domain must be valid
- No local file access
## Acceptance Criteria
- [ ] Can open URLs in default browser
- [ ] Pack-defined websites are queryable
- [ ] Tag-based queries work
- [ ] URL validation prevents dangerous URLs
- [ ] Permission checks enforced
- [ ] Works on all target platforms
- [ ] Clear error messages
- [ ] No security vulnerabilities
## Dependencies
- Requires: #3 Pack Asset Loading
- Requires: #6 deno_core Runtime Setup
- Requires: #8 Permissions System
## Related Issues
- #1 Architecture Documentation
